---
id: index
title: è·‘é€šä¸Šäº‘API Demo
sidebar_label: è·‘é€šä¸Šäº‘API Demo
sidebar_position: 1
description: SBIM ç³»ç»Ÿè®¾å¤‡é€‚é…ä¸Šäº‘APIçš„å®Œæ•´å¼€å‘æŒ‡å—
---
# è·‘é€šä¸Šäº‘API Demo

> è¿™æ˜¯ä¸€ä»½**ä» 0 åˆ° 1**çš„åŠ¨æ‰‹æŒ‡å—ï¼šå¸¦ä½ åœ¨æœ¬æœº/äº‘ä¸»æœºä¸Šæ‹‰èµ·ä¾èµ–æœåŠ¡ï¼Œå¯¼å…¥ç¤ºä¾‹æ•°æ®ï¼Œè·‘é€šä¸Šäº‘API Demoï¼Œå¹¶ä¸ºä¸‹ä¸€æ­¥çš„æ·»åŠ  **SuperDock** è®¾å¤‡çš„é€‚é…åšå¥½å‡†å¤‡ã€‚

:::tip ä½ å°†è·å¾—

* ä¸€å¥—å¯ç›´æ¥è¿è¡Œçš„ Docker åŒ–åŸºç¡€ç¯å¢ƒï¼ˆEMQXã€MySQLã€Redisã€MinIOã€SRSï¼‰ã€‚
* å·²å¯¼å…¥çš„ç¤ºä¾‹æ•°æ®åº“ï¼Œä¾¿äºæœ¬åœ°è”è°ƒä¸å›å½’ã€‚
* æ˜ç¡®çš„ç‰ˆæœ¬è¦æ±‚ä¸å¸¸è§å‘ä½æç¤ºï¼ˆç«¯å£ã€ç½‘ç»œã€æƒé™ï¼‰ã€‚
* SuperDock å¯¹æ¥çš„æœ€ä½³å®è·µå…¥å£ï¼ˆä¸‹æ–‡æœ‰ç›´è¾¾é“¾æ¥ï¼‰ã€‚

:::

## ä¸ºä»€ä¹ˆé€‰æ‹© DJI ä¸Šäº‘ API

* **é™ä½è¿ç§»æˆæœ¬**ï¼šæ¥å£ç»Ÿä¸€ã€ç”Ÿæ€æˆç†Ÿï¼›åœ¨å…¼å®¹è¯¥æ¥å£åï¼Œå®¢æˆ·å¯å¤ç”¨ç°æœ‰ç³»ç»Ÿä¸ç»éªŒï¼Œæ— éœ€é‡æ–°å­¦ä¹ ï¼Œå¤§å¹…å‡å°‘å¼€å‘ä¸åŸ¹è®­æˆæœ¬ã€‚
* **æå‡ç³»ç»Ÿå…¼å®¹æ€§**ï¼šé€šè¿‡æ ‡å‡†åŒ–æ¥å£ï¼ŒSuperDock å¯ä¸ DJI è®¾å¤‡ç»Ÿä¸€ç®¡ç†ï¼Œæ”¯æŒæ··åˆéƒ¨ç½²ï¼Œç®€åŒ–é›†æˆæµç¨‹ï¼Œä¿éšœç¨³å®šæ€§ä¸çµæ´»æ€§ã€‚

---

## å…è´£å£°æ˜ä¸ä½¿ç”¨é¡»çŸ¥

> æœ¬æ–‡åŸºäº **ä¸Šäº‘API Demo** é¡¹ç›®ç¼–å†™ï¼Œä»…ä¾›æŠ€æœ¯å‚è€ƒä¸å­¦ä¹ ã€‚ç¤ºä¾‹å¹¶ä¸ç­‰äºç”Ÿäº§æ–¹æ¡ˆï¼Œè¯·åŠ¡å¿…åœ¨ä¸Šçº¿å‰å®Œæˆ**å®‰å…¨è¯„ä¼°ä¸å®¡è®¡**ã€‚

* **æŠ€æœ¯å‚è€ƒ**ï¼šæ–‡ä¸­ç¤ºä¾‹ä»£ç ä¸é…ç½®å‡ä¸ºå‚è€ƒå®ç°ï¼Œæ¥è‡ªå¹¶æ‰©å±•è‡ªå¼€æº Demoï¼Œä¸æ„æˆç”Ÿäº§çº§æ–¹æ¡ˆã€‚
* **å®‰å…¨æç¤º**ï¼šDemo å¯èƒ½å­˜åœ¨å®‰å…¨éšæ‚£ï¼ˆå¦‚æ•°æ®æš´éœ²ã€é‰´æƒä¸è¶³ç­‰ï¼‰ã€‚ä¸è¦ç›´æ¥æš´éœ²åœ¨å…¬ç½‘ï¼›å¦‚éœ€å¯¹å¤–ï¼Œè¯·è¿›è¡ŒåŠ å›ºï¼ˆç½‘ç»œéš”ç¦»ã€æœ€å°æƒé™ã€WAFã€å®¡è®¡æ—¥å¿—ç­‰ï¼‰ã€‚
* **å…¼å®¹æ€§**ï¼šSuperDock ä¸ ä¸Šäº‘ API **Demo** çš„å…¼å®¹æ€§åŸºäºå½“å‰ç‰ˆæœ¬éªŒè¯ï¼›è®¾å¤‡å›ºä»¶ä¸ API ç‰ˆæœ¬å˜æ›´å¯èƒ½å½±å“ç»“æœï¼Œæ­£å¼éƒ¨ç½²å‰è¯·åšå……åˆ†å›å½’ã€‚
* **å…è´£**ï¼šå› å‚è€ƒæœ¬æ–‡é€ æˆçš„ä¸šåŠ¡ä¸­æ–­ã€æ•°æ®æŸå¤±ã€å®‰å…¨äº‹ä»¶ã€ç¬¬ä¸‰æ–¹ç´¢èµ”ã€è®¾å¤‡æŸåç­‰ï¼Œ**è‰è“åˆ›æ–°åŠç›¸å…³äººå‘˜ä¸æ‰¿æ‹…è´£ä»»**ã€‚

> ç”Ÿäº§å»ºè®®ï¼šéš”ç¦»ç¯å¢ƒå¼€å‘â†’ä¸“ä¸šå®‰å…¨å®¡è®¡â†’å¤‡ä»½ä¸æ¢å¤æ–¹æ¡ˆâ†’ç›‘æ§ä¸å‘Šè­¦â†’æŒç»­æ›´æ–°è¡¥ä¸ã€‚

---

## å‡†å¤‡å·¥ä½œï¼ˆPrerequisitesï¼‰

* ä¸€å° Linux äº‘æœåŠ¡å™¨ï¼ˆå»ºè®® Ubuntu 20.04+ï¼Œ16.04 äº¦å¯ï¼‰æˆ–æœ¬åœ° Linux/Mac ç¯å¢ƒã€‚
* **Docker** ä¸ **Docker Compose**

    * å®‰è£…æ•™ç¨‹ï¼š

        * Docker: [https://docs.docker.com/engine/install/ubuntu/](https://docs.docker.com/engine/install/ubuntu/)
        * Compose: [https://docs.docker.com/compose/install/](https://docs.docker.com/compose/install/)
* ï¼ˆæºç ç¼–è¯‘åœºæ™¯ï¼‰**Java 11+**ã€**Node.js 17.8**ã€**Nginx 1.20.2** ç­‰ã€‚

:::caution ç«¯å£ä¸ç½‘ç»œ

* éœ€å ç”¨ç«¯å£ï¼š`1883/8883/18083`ï¼ˆEMQXï¼‰ã€`3306`ï¼ˆMySQLï¼‰ã€`6379`ï¼ˆRedisï¼‰ã€`9000/9001`ï¼ˆMinIOï¼‰ã€`1935/1985/8080/8000`ï¼ˆSRSï¼‰ã€‚
* Compose é»˜è®¤åˆ›å»º `192.168.6.0/24` çš„ bridge ç½‘ç»œï¼Œè¯·ç¡®ä¿ä¸ç°ç½‘æ— å†²çªã€‚
  :::

---

## è·å–ç¤ºä¾‹åŒ…

* ç›´æ¥ä¸‹è½½æ‰“åŒ…èµ„æºï¼ˆå«é•œåƒä¸ç¤ºä¾‹æ–‡ä»¶ï¼‰ï¼š

  **[ä¸‹è½½æºç åŒ…](https://terra-sz-hc1pro-cloudapi.oss-cn-shenzhen.aliyuncs.com/c0af9fe0d7eb4f35a8fe5b695e4d0b96/docker/cloud_api_sample_docker.zip)**

è§£å‹ `cloud_api_sample_docker.zip` åï¼Œå¯è§ç±»ä¼¼ç›®å½•ç»“æ„ï¼š

```text
root@server:~/djicloud/cloud_api_sample# ls
cloud_api_sample_docker_v1.10.0.tar  docker-compose.yml  update_backend.sh
data                                 source              update_front.sh
```

> è¯´æ˜ï¼šç›®å½•åå¯èƒ½éšç‰ˆæœ¬ç•¥æœ‰å·®å¼‚ï¼›æ ¸å¿ƒæ–‡ä»¶åŒ…æ‹¬ `docker-compose.yml`ã€`data/`ï¼ˆæ•°æ®æŒä¹…åŒ–ï¼‰ã€`source/`ï¼ˆæºç ä¸ SQL ä½ç½®ï¼‰åŠé¢„æ‰“åŒ…é•œåƒ tarã€‚

---

## å¯åŠ¨ä¾èµ–æœåŠ¡ï¼ˆDocker Composeï¼‰

1ï¼‰å°† `docker-compose.yml` æ›¿æ¢ä¸ºä¸‹è¿°å†…å®¹ï¼š

```yaml
version: "3"
services:
  emqx:
    image: emqx:4.4
    ports:
      - "18083:18083"
      - "1883:1883"
      - "8083:8083"
      - "8883:8883"
      - "8084:8084"
    environment:
      - EMQX_ALLOW_ANONYMOUS=true # ä»…é™æœ¬åœ°/æ¼”ç¤ºç¯å¢ƒï¼
    hostname: emqx-broker
    networks:
      - cloud_service_bridge

  mysql:
    image: mysql:latest
    networks:
      - cloud_service_bridge
    ports:
      - "3306:3306"
    volumes:
      - /etc/localtime:/etc/localtime
      - ./data/mysql:/var/lib/mysql
    environment:
      - MYSQL_ROOT_PASSWORD=root
    hostname: cloud_api_sample_mysql

  redis:
    image: redis:6.2
    restart: always
    hostname: cloud_api_sample_redis
    ports:
      - "6379:6379"
    networks:
      - cloud_service_bridge
    command: ["redis-server"]

  minio:
    image: minio/minio:latest
    container_name: minio
    environment:
      - MINIO_ROOT_USER=minioadmin
      - MINIO_ROOT_PASSWORD=minioadmin
      - TZ=Asia/Shanghai
    ports:
      - "9000:9000"
      - "9001:9001"
    volumes:
      - ./data/minio:/data
      - ./data/minio/logs:/var/log/minio
      - /etc/localtime:/etc/localtime
    command: ["server", "/data", "--console-address", ":9001"]
    restart: always

  srs:
    image: ossrs/srs
    container_name: sd.srsdemo
    hostname: srsdemo
    ports:
      - "1935:1935"
      - "1985:1985"
      - "8080:8080"
      - "8000:8000"
      - "8000:8000/udp"
    environment:
      - CANDIDATE=ã€æ›¿æ¢ä¸ºæœåŠ¡å™¨å¯¹å¤–å¯è¾¾IPã€‘
    command: ["objs/srs", "-c", "conf/rtmp2rtc.conf"]
    restart: always

networks:
  cloud_service_bridge:
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.6.0/24
```

2ï¼‰å¯åŠ¨ï¼š

```bash
sudo docker compose up -d
```

3ï¼‰éªŒè¯æœåŠ¡æ˜¯å¦å°±ç»ªï¼š

```bash
sudo docker ps --format "table {{.Names}}\t{{.Image}}\t{{.Status}}\t{{.Ports}}"
```

åº”èƒ½çœ‹åˆ° `emqx` / `mysql` / `redis` / `minio` / `sd.srsdemo` å‡ä¸º `Up` çŠ¶æ€ã€‚

:::tip å¸¸è§æ£€æŸ¥ç‚¹

* `CANDIDATE` å¿…é¡»æ˜¯ SRS å¯è¢«å¤–ç½‘/è®¾å¤‡è®¿é—®åˆ°çš„ IPï¼ˆæˆ–å†…ç½‘è”è°ƒç¯å¢ƒçš„çœŸå®å¯è¾¾ IPï¼‰ã€‚
* `EMQX_ALLOW_ANONYMOUS=true` ä»…ä¾›å¼€å‘é˜¶æ®µä½¿ç”¨ï¼›ç”Ÿäº§åŠ¡å¿…å…³é—­åŒ¿åå¹¶æ¥å…¥é‰´æƒã€‚
* è‹¥ç«¯å£è¢«å ç”¨ï¼Œå…ˆæ’æŸ¥å®¿ä¸»æœºå·²æœ‰æœåŠ¡æˆ–è°ƒæ•´æ˜ å°„ç«¯å£ã€‚
  :::

---

## å¯¼å…¥ç¤ºä¾‹æ•°æ®åº“ï¼ˆcloud_sample.sqlï¼‰

1ï¼‰å®šä½ SQL æ–‡ä»¶ï¼š

```text
source/backend_service/sql/cloud_sample.sql
```

2ï¼‰å°†æ•°æ®å¯¼å…¥åˆ°å®¹å™¨å†…çš„ MySQLï¼š

```bash
sudo docker exec -i cloud_api_sample-mysql-1 \
  mysql -uroot -proot < source/backend_service/sql/cloud_sample.sql
```

> å¦‚æœå½“å‰ç›®å½•ä¸åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼Œè¯·å°† `cloud_sample.sql` çš„è·¯å¾„æ›¿æ¢ä¸ºä½ çš„å®é™…è·¯å¾„ã€‚

3ï¼‰éªŒè¯æ•°æ®åº“æ˜¯å¦åˆ›å»ºæˆåŠŸï¼š

```bash
sudo docker exec -it cloud_api_sample-mysql-1 \
  mysql -uroot -proot -e "SHOW DATABASES LIKE 'cloud_sample';"
```

æ­£å¸¸è¾“å‡ºç¤ºä¾‹ï¼š

```text
+-------------------------+
| Database (cloud_sample) |
+-------------------------+
| cloud_sample            |
+-------------------------+
```

---

## æºç è·å–ä¸äºŒæ¬¡å¼€å‘

Demo é‡‡ç”¨å‰åç«¯åˆ†ç¦»ï¼šå‰ç«¯ **TS + Vue3**ï¼Œåç«¯ **Java 11+ / Spring Boot**ã€‚å»ºè®®å…ˆæŒ‰ä¸Šæ–‡è·‘é€šä¾èµ–ï¼Œå†æ‹‰å–æºç è¿›è¡ŒäºŒæ¬¡å¼€å‘ã€‚

**å‰ç«¯éœ€è¦**ï¼šTypeScript / HTML / CSSã€Vue 3.xã€Node.jsï¼ˆnpm/yarnï¼‰ã€Ant Design Vue v2ã€HTTP/WebSocketã€Nginxï¼ˆç”¨äºéƒ¨ç½²ï¼‰ã€‚

**åç«¯éœ€è¦**ï¼šJava 11+ã€Spring Bootã€MQTTã€MySQLã€WebSocketã€Redisã€‚

**å‚è€ƒç‰ˆæœ¬**ï¼š

* Linuxï¼šUbuntu 20.04+
* Javaï¼šOpenJDK 11+
* MySQLï¼š8.0.26
* EMQXï¼š4.4.0
* Redisï¼š6.2
* Nginxï¼š1.20.2
* Vueï¼š3.0.5
* Node.jsï¼š17.8

**æŠ€æœ¯æ”¯æŒä¸èµ„æº**ï¼š

* **è‰è“åˆ›æ–°å®˜ç½‘**ï¼š[https://sb.im/](https://sb.im/)
* **ä¸Šäº‘ API æ–‡æ¡£**ï¼š[https://developer.dji.com/doc/cloud-api-tutorial/cn/](https://developer.dji.com/doc/cloud-api-tutorial/cn/)
* **å¼€æºåç«¯**ï¼š[https://github.com/dji-sdk/DJI-Cloud-API-Demo](https://github.com/dji-sdk/DJI-Cloud-API-Demo)
* **å¼€æºå‰ç«¯**ï¼š[https://github.com/dji-sdk/Cloud-API-Demo-Web](https://github.com/dji-sdk/Cloud-API-Demo-Web)

> è‹¥éœ€è¦æ„å»ºè‡ªå®šä¹‰é•œåƒï¼Œå¯å‚è€ƒä»“åº“å†…è„šæœ¬ `update_backend.sh` / `update_front.sh`ã€‚

---

## æ—¥å¿—æŸ¥çœ‹

**å¸¸ç”¨æ—¥å¿—ä½ç½®ä¸ç¤ºä¾‹å‘½ä»¤**ï¼š

```bash
# åº”ç”¨æ—¥å¿—
tail -f logs/cloud-api-demo.log

# MQTT è¿æ¥æ—¥å¿—
grep "MQTT" logs/cloud-api-demo.log

# è®¾å¤‡æ³¨å†Œæ—¥å¿—
grep "thing.register" logs/cloud-api-demo.log

# é”™è¯¯æ—¥å¿—
grep "ERROR" logs/cloud-api-demo.log
```

---

## ä¸‹ä¸€æ­¥ï¼šå¯¹æ¥ SuperDock è®¾å¤‡

* å¦‚æœä½ åªæƒ³å…ˆè·‘é€š Demoï¼Œåˆ°è¿™é‡ŒåŸºæœ¬å®Œæˆ âœ…ã€‚
* å¦‚æœä½ è¦è®© Demo æ­£ç¡®è¯†åˆ«ã€ç®¡ç† **SuperDock ç³»åˆ—æœºåœº**ï¼Œè¯·ç»§ç»­é˜…è¯»ä¸‹ä¸€ç¯‡ï¼š

ğŸ‘‰ **[å¿«é€Ÿå¯¹æ¥ SuperDock è®¾å¤‡](./superdock)**

---